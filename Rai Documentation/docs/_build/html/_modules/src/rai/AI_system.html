<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>src.rai.AI_system &mdash; RAI Documentation 0.1 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script src="../../../_static/clipboard.min.js"></script>
        <script src="../../../_static/copybutton.js"></script>
        <script src="../../../_static/tabs.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> RAI Documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../RaiModule/RAI%20in%20Responsible%20AI.html"><strong>RAI Responsible in AI</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../RaiModule/RAI%20Bias%20and%20Fairness.html"><strong>RAI - Bias and Fairness</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../RaiModule/Robustness%20of%20AI.html"><strong>Robustness of AI</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../RaiModule/RAI%20in%20Model%20Selection.html"><strong>Model Selection</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../RaiModule/Installation.html"><strong>Installation</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../RaiModule/Getting%20Started.html"><strong>Getting Started</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../RaiModule/Tutorial%20Demo.html"><strong>Demo Cases</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../RaiModule/Dashboard.html"><strong>Dashboard</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../RaiModule/Basic%20component%20of%20RAI%20Design.html"><strong>Basic component of RAI Design:</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../RaiModule/Contribute%20and%20extend%20RAI.html"><strong>Contribute and Extend RAI</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../RaiModule/Contribute%20and%20extend%20RAI.html#contribution-of-users-to-expand-its-features"><strong>Contribution of users to expand its features</strong></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference Class</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../rai.html">Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">RAI Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>src.rai.AI_system</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for src.rai.AI_system</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2022 Cisco Systems, Inc. and its affiliates</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#      http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
<span class="c1">#</span>
<span class="c1"># SPDX-License-Identifier: Apache-2.0</span>

<span class="kn">from</span> <span class="nn">RAI.AISystem.model</span> <span class="kn">import</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">RAI.certificates</span> <span class="kn">import</span> <span class="n">CertificateManager</span>
<span class="kn">from</span> <span class="nn">RAI.dataset.dataset</span> <span class="kn">import</span> <span class="n">Data</span><span class="p">,</span> <span class="n">NumpyData</span><span class="p">,</span> <span class="n">IteratorData</span><span class="p">,</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">MetaDatabase</span>
<span class="kn">from</span> <span class="nn">RAI.metrics</span> <span class="kn">import</span> <span class="n">MetricManager</span>
<span class="kn">from</span> <span class="nn">RAI.all_types</span> <span class="kn">import</span> <span class="n">all_output_requirements</span><span class="p">,</span> <span class="n">all_task_types</span><span class="p">,</span> <span class="n">all_metric_types</span>

<div class="viewcode-block" id="AISystem"><a class="viewcode-back" href="../../../rai.html#src.rai.AI_system.AISystem">[docs]</a><span class="k">class</span> <span class="nc">AISystem</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    AI Systems are the main class users interact with in RAI.</span>
<span class="sd">    When constructed, AISystems are passed a name, a task type, a MetaDatabase, a Dataset and a Model.</span>


<span class="sd">    :param name: Create a new string object from the given object. If encoding or errors is specified, then the object must expose a data buffer that will be decoded using the given encoding and error handler. Otherwise, returns the result of object.__str__() (if defined) or repr(object). encoding defaults to sys.getdefaultencoding(). errors defaults to &#39;strict&#39;.</span>
<span class="sd">    :param task: Create a new string object from the given object. If encoding or errors is specified, then the object must expose a data buffer that will be decoded using the given encoding and error handler. Otherwise, returns the result of object.__str__() (if defined) or repr(object). encoding defaults to sys.getdefaultencoding(). errors defaults to &#39;strict&#39;.</span>
<span class="sd">    :param meta_database: The RAI MetaDatabase class holds Meta information about the Dataset. It includes information about the features, and contains maps and masks to quick get access to the different feature data of different information.</span>
<span class="sd">    :param dataset: The RAI Dataset class holds a dictionary of RAI Data classes, for example {&#39;train&#39;: trainData, &#39;test&#39;: testData}, where trainData and testData are RAI Data objects</span>
<span class="sd">    :param model: Model is RAIs abstraction for the ML Model performing inferences. When constructed, models are optionally passed the name, the models functions for inferences, its name, the model, its optimizer, its loss function, its class and a description. Attributes of the model are used to determine which metrics are relevant. </span>
<span class="sd">    :param enable_certificates: Returns True when the argument x is true, False otherwise. The builtins True and False are the only two instances of the class bool. The class bool is a subclass of the class int, and cannot be subclassed. </span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                 <span class="n">task</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                 <span class="n">meta_database</span><span class="p">:</span> <span class="n">MetaDatabase</span><span class="p">,</span>
                 <span class="n">dataset</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">,</span>
                 <span class="n">model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
                 <span class="n">enable_certificates</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">all_task_types</span><span class="p">,</span> <span class="s2">&quot;Task must be in &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">all_task_types</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">=</span> <span class="n">task</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta_database</span> <span class="o">=</span> <span class="n">meta_database</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enable_certificates</span> <span class="o">=</span> <span class="n">enable_certificates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auto_id</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_metric_values</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_certificate_values</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metric_manager</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">certificate_manager</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_summarizer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_config</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="AISystem.initialize"><a class="viewcode-back" href="../../../rai.html#src.rai.AI_system.AISystem.initialize">[docs]</a>    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_config</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">custom_certificate_location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    </span>
<span class="sd">        :param user_config(dict): Takes user config as a dict</span>
<span class="sd">        :param custom_certificate_location(str): certificate path by default it is None</span>
<span class="sd">    </span>
<span class="sd">        :return: None </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_config</span> <span class="o">=</span> <span class="n">user_config</span>
        <span class="n">masks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;scalar&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta_database</span><span class="o">.</span><span class="n">scalar_mask</span><span class="p">,</span> <span class="s2">&quot;categorical&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta_database</span><span class="o">.</span><span class="n">categorical_mask</span><span class="p">,</span>
                 <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta_database</span><span class="o">.</span><span class="n">image_mask</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta_database</span><span class="o">.</span><span class="n">text_mask</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">separate_data</span><span class="p">(</span><span class="n">masks</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta_database</span><span class="o">.</span><span class="n">initialize_requirements</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">,</span> <span class="s2">&quot;fairness&quot;</span> <span class="ow">in</span> <span class="n">user_config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metric_manager</span> <span class="o">=</span> <span class="n">MetricManager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">certificate_manager</span> <span class="o">=</span> <span class="n">CertificateManager</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">certificate_manager</span><span class="o">.</span><span class="n">load_stock_certificates</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">custom_certificate_location</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">certificate_manager</span><span class="o">.</span><span class="n">load_custom_certificates</span><span class="p">(</span><span class="n">custom_certificate_location</span><span class="p">)</span></div>
        <span class="c1"># self.data_summarizer = DataSummarizer(self.dataset, self.model.output_features[0].possibleValues, self.task)</span>

<div class="viewcode-block" id="AISystem.get_metric_values"><a class="viewcode-back" href="../../../rai.html#src.rai.AI_system.AISystem.get_metric_values">[docs]</a>    <span class="k">def</span> <span class="nf">get_metric_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the last metric values in the form of key value pair</span>

<span class="sd">        :param self: None</span>
<span class="sd">        :return: last metric values(dict)</span>
<span class="sd">        </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_metric_values</span></div>

<div class="viewcode-block" id="AISystem.display_metric_values"><a class="viewcode-back" href="../../../rai.html#src.rai.AI_system.AISystem.display_metric_values">[docs]</a>    <span class="k">def</span> <span class="nf">display_metric_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">display_detailed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param display_detailed(boolean): if True we need to display metric explanation if False we don&#39;t have to display </span>
<span class="sd">    </span>
<span class="sd">        :return: None</span>

<span class="sd">        Displays the metric values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_metric_values</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metric_info</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">===== &quot;</span> <span class="o">+</span> <span class="n">dataset</span> <span class="o">+</span> <span class="s2">&quot; Dataset =====&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">[</span><span class="n">dataset</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">----- &quot;</span> <span class="o">+</span> <span class="n">info</span><span class="p">[</span><span class="n">group</span><span class="p">][</span><span class="s1">&#39;meta&#39;</span><span class="p">][</span><span class="s2">&quot;display_name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; Metrics -----&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">[</span><span class="n">dataset</span><span class="p">][</span><span class="n">group</span><span class="p">]:</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="n">group</span><span class="p">][</span><span class="n">metric</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">all_metric_types</span><span class="p">):</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="n">group</span><span class="p">][</span><span class="n">metric</span><span class="p">][</span><span class="s2">&quot;display_name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span><span class="p">,</span> <span class="n">vals</span><span class="p">[</span><span class="n">dataset</span><span class="p">][</span><span class="n">group</span><span class="p">][</span><span class="n">metric</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">display_detailed</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="n">group</span><span class="p">][</span><span class="n">metric</span><span class="p">][</span><span class="s2">&quot;display_name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; is &quot;</span> <span class="o">+</span> <span class="n">info</span><span class="p">[</span><span class="n">group</span><span class="p">][</span><span class="n">metric</span><span class="p">][</span><span class="s2">&quot;explanation&quot;</span><span class="p">],</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="AISystem.get_certificate_values"><a class="viewcode-back" href="../../../rai.html#src.rai.AI_system.AISystem.get_certificate_values">[docs]</a>    <span class="k">def</span> <span class="nf">get_certificate_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the last used certificate information</span>

<span class="sd">        :param self:  None</span>
<span class="sd">    </span>
<span class="sd">        :return: Certificate infomation(dict)</span>
<span class="sd">         Returns the last used certificate information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_certificate_values</span></div>

<div class="viewcode-block" id="AISystem.get_data"><a class="viewcode-back" href="../../../rai.html#src.rai.AI_system.AISystem.get_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Data</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get_data accepts data_type and returns the data object information</span>

<span class="sd">        :param data_type(str):  Get the data type information</span>
<span class="sd">    </span>
<span class="sd">        :return: Dataset datatype information(str)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">data_type</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="AISystem.get_project_info"><a class="viewcode-back" href="../../../rai.html#src.rai.AI_system.AISystem.get_project_info">[docs]</a>    <span class="k">def</span> <span class="nf">get_project_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fetch the project information like name, configuration, metric user config and Returns the project details</span>
<span class="sd">         </span>
<span class="sd">        :param self:  None</span>
<span class="sd">    </span>
<span class="sd">        :return: Project details(dict)</span>

<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                  <span class="s2">&quot;task_type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">task</span><span class="p">,</span> <span class="s2">&quot;configuration&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metric_manager</span><span class="o">.</span><span class="n">user_config</span><span class="p">,</span> <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="p">[],</span>
                  <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">description</span><span class="p">,</span> <span class="s2">&quot;output_features&quot;</span><span class="p">:</span> <span class="p">[]}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta_database</span><span class="o">.</span><span class="n">features</span><span class="p">)):</span>
            <span class="n">result</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta_database</span><span class="o">.</span><span class="n">features</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">output_features</span><span class="p">)):</span>
            <span class="n">result</span><span class="p">[</span><span class="s1">&#39;output_features&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">output_features</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="AISystem.get_data_summary"><a class="viewcode-back" href="../../../rai.html#src.rai.AI_system.AISystem.get_data_summary">[docs]</a>    <span class="k">def</span> <span class="nf">get_data_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        process the data and returns the summary consisting of prediction, label details</span>

<span class="sd">        :param self:  None</span>
<span class="sd">    </span>
<span class="sd">        :return: Data Summary(Dict)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pred_target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_summarizer</span><span class="o">.</span><span class="n">target</span> 
        <span class="n">label_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_summarizer</span><span class="o">.</span><span class="n">label_name_dict</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_summarizer</span><span class="o">.</span><span class="n">labels</span> 
        <span class="n">label_dist_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_summarizer</span><span class="o">.</span><span class="n">getLabelDistribution</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">label_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">label_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="c1"># TODO: Add data sampler</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;pred_target&quot;</span><span class="p">:</span> <span class="n">pred_target</span><span class="p">,</span>
            <span class="s2">&quot;label_name&quot;</span><span class="p">:</span> <span class="n">label_name</span><span class="p">,</span>
            <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="n">labels</span><span class="p">,</span>
            <span class="s2">&quot;label_dist&quot;</span><span class="p">:</span> <span class="n">label_dist_dict</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">summary</span></div>
    
    <span class="k">def</span> <span class="nf">_single_compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># Single compute accepts predictions and the name of a dataset, and then calculates metrics for that dataset.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auto_id</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">auto_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">data_type</span><span class="p">)}</span>
        <span class="k">for</span> <span class="n">output_type</span> <span class="ow">in</span> <span class="n">all_output_requirements</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">output_type</span> <span class="ow">in</span> <span class="n">predictions</span><span class="p">:</span>
                <span class="n">data_dict</span><span class="p">[</span><span class="n">output_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">output_type</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">output_type</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">:</span>
                <span class="n">data_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">output_type</span><span class="p">)</span>
        <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;tag&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tag</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span> <span class="o">=</span> <span class="n">data_dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metric_manager</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_config</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">],</span> <span class="n">NumpyData</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_metric_values</span><span class="p">[</span><span class="n">data_type</span> <span class="k">if</span> <span class="n">data_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;No Dataset&quot;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">metric_manager</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">],</span> <span class="n">IteratorData</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_metric_values</span><span class="p">[</span><span class="n">data_type</span> <span class="k">if</span> <span class="n">data_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;No Dataset&quot;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">metric_manager</span><span class="o">.</span><span class="n">iterator_compute</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">enable_certificates</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_certificate_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">certificate_manager</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_metric_values</span><span class="p">)</span>

    <span class="c1"># Compute will tell RAI to compute metric values across each dataset which predictions were made on.</span>
<div class="viewcode-block" id="AISystem.compute"><a class="viewcode-back" href="../../../rai.html#src.rai.AI_system.AISystem.compute">[docs]</a>    <span class="k">def</span> <span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute will tell RAI to compute metric values across each dataset which predictions were made on</span>

<span class="sd">        :param predictions(dict): Prediction value from the classifier </span>
<span class="sd">        :param tag: by default None</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_metric_values</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">data_dict</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Model with no X, y data.</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">predictions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_single_compute</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">predictions</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> \
                <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">predictions</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Prediction dictionary should be in the form [dataset][output_type] -&gt; nd.array&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">predictions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">data_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_single_compute</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">key</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span></div>

    <span class="c1"># Run Compute automatically generates outputs from the model, and compute metrics based on those outputs</span>
<div class="viewcode-block" id="AISystem.run_compute"><a class="viewcode-back" href="../../../rai.html#src.rai.AI_system.AISystem.run_compute">[docs]</a>    <span class="k">def</span> <span class="nf">run_compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run Compute automatically generates outputs from the model, and compute metrics based on those outputs</span>

<span class="sd">        :param tag: tag by default None or we can pass model as a string</span>
<span class="sd">    </span>
<span class="sd">        :return: Data Summary(Dict)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_metric_values</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">preds</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">data_dict</span><span class="p">:</span>
            <span class="n">preds</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">data_dict</span><span class="p">[</span><span class="n">category</span><span class="p">]</span><span class="o">.</span><span class="n">X</span>
            <span class="k">for</span> <span class="n">function_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">output_types</span><span class="p">:</span>
                <span class="n">preds</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">function_type</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">output_types</span><span class="p">[</span><span class="n">function_type</span><span class="p">](</span><span class="n">data</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">preds</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_single_compute</span><span class="p">(</span><span class="n">preds</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">key</span><span class="p">)</span></div>

<div class="viewcode-block" id="AISystem.get_metric_info"><a class="viewcode-back" href="../../../rai.html#src.rai.AI_system.AISystem.get_metric_info">[docs]</a>    <span class="k">def</span> <span class="nf">get_metric_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the metadata of the metric_manager class</span>

<span class="sd">        :param self: None</span>
<span class="sd">        :return: metric Manager metadata</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metric_manager</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span></div>

<div class="viewcode-block" id="AISystem.get_certificate_info"><a class="viewcode-back" href="../../../rai.html#src.rai.AI_system.AISystem.get_certificate_info">[docs]</a>    <span class="k">def</span> <span class="nf">get_certificate_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the metadata of the certificate_manager class</span>

<span class="sd">        :param self: None</span>

<span class="sd">        :return: Certificate info from certificate_manager</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">      </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">certificate_manager</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span></div>

    <span class="c1"># we have not implemented the incremental update as of now and each call to compute process all the data</span>
<div class="viewcode-block" id="AISystem.update"><a class="viewcode-back" href="../../../rai.html#src.rai.AI_system.AISystem.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">raise</span> <span class="bp">NotImplemented</span><span class="p">()</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, sharfa.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>